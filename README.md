# zkbob-generator

An HTTP API server for generating zero-knowledge proofs for zkbob.

## Setup

<b> Environment variable (.env) file : </b> 

```
PORT=5000
```

<b>Supervisord setup : </b> 

```

[program:zkbob-generator]
command=/app/zkbob_generator
autorestart=true
autostart=false
environment=PORT=6000
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stdout
stderr_logfile_maxbytes=0
```

## Running the generator

`Note` : Make sure to run the generator in release mode for the best performance.

```
cargo run --release
```

## API endpoints

⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃

## End-point: generateProof
### Method: POST
>```
>{{endpoint}}/api/generateProof
>```


### Body (**JSON**)

```
{
    "ask": Ask,
    "private_input": Vec<u8>,
    "ask_id": u64,
}
```


<b>Ask struct for reference:</b>
```
Ask {
    "market_id": U256,
    "reward": U256,
    "expiry": U256,
    "time_taken_for_proof_generation": U256,
    "deadline": U256,
    "refund_address": Address,
    "prover_data": Bytes,
}
```

### Response

`Note` : The data field will return the zero-knowledge if the inputs are valid and signature if the inputs are invalid.

```
{
    "message": "Proof generated",
    "data": "0x0237a975b80a84ac4ad16d041cea290ae778f94c10984d62a17d30ec291e3e86158796ef2e95e934875ddf94c6d457521501db49a8d948b91d18e7c6d5e872e425dc1c063df1c23406e5ba80679eee4c90905a95bac84298b264cef31b7f36af14fca0f89520080c50dcd1dbd640172b49eab8dca2dc3d2fa16a65334a3b1bd3228c7afa50365c5b898c4231afdf24494cea519aec1be9a76bd96cfb3e332fe8172a2380d7d5efa17bb0adaf3a86b9bfc66fd16d77cc2f7c77f8d061966c54c8111d7ccf766517d8112951281dbe1d8b48aef94c5fcc5bb3b08e02f8a934d7c925c05425cc2129f769d109b0f340ca14a87d5a658c688111c982899c7d8692ca"
}
```

### Generator logs : 

```
[2024-04-03T11:12:26Z INFO  zkbob_generator::handler] Request received by the zkb generator for ask ID : 173
[2024-04-03T11:12:26Z INFO  zkbob_generator::zkbob_generator] Proof generation started...
[2024-04-03T11:12:34Z INFO  zkbob_generator::zkbob_generator] Proof generation time: 7.939795383s
[2024-04-03T11:12:34Z INFO  zkbob_generator::zkbob_generator] Proof verification status : true
[2024-04-03T11:12:34Z INFO  zkbob_generator::zkbob_generator] proof: Some(Bytes(0x0237a975b80a84ac4ad16d041cea290ae778f94c10984d62a17d30ec291e3e86158796ef2e95e934875ddf94c6d457521501db49a8d948b91d18e7c6d5e872e425dc1c063df1c23406e5ba80679eee4c90905a95bac84298b264cef31b7f36af14fca0f89520080c50dcd1dbd640172b49eab8dca2dc3d2fa16a65334a3b1bd3228c7afa50365c5b898c4231afdf24494cea519aec1be9a76bd96cfb3e332fe8172a2380d7d5efa17bb0adaf3a86b9bfc66fd16d77cc2f7c77f8d061966c54c8111d7ccf766517d8112951281dbe1d8b48aef94c5fcc5bb3b08e02f8a934d7c925c05425cc2129f769d109b0f340ca14a87d5a658c688111c982899c7d8692ca))
[2024-04-03T11:12:34Z INFO  zkbob_generator::handler] Proof generated by the zkb generator for ask ID : 173
```

⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃ ⁃

## End-point: benchmark
### Method: GET
>```
>{{endpoint}}/api/benchmark
>```

### Response

```
{
    "message": "Proof generated, the proof generation time returned is in milliseconds",
    "data": "8725"
}
```